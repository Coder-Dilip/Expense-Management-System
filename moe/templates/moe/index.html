{% extends 'layouts/base.html' %}

{% block title %} Dashboard {% endblock title %}

<!-- Specific CSS goes HERE -->
{% block stylesheets %}
<style>
  body {
  background-color: #f3f5f7;
  font-family: 'Helvetica Neue', Arial, sans-serif;
}


.cards {
  background-color: #fff;
  box-shadow: 0 0 6px rgba(0, 0, 0, 0.1);
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  max-width: 300px;
  height: 375px;
  border-radius: 10px;
  overflow: hidden;
}

.cards .about {
  height: 225px;
  padding: 20px;
  box-sizing: border-box;
}

.cards .about h3,
.cards .about .lead {
  font-weight: 300;
  margin: 0;
}

.cards .about h3 {
  font-size: 24px;
}

.cards .about .lead {
  color: #aaa;
}

.cards .info {
  float: left;
  padding: 10px 30px 10px 0;
}

.cards .info p {
  font-size: 11px;
  color: #aaa;
  font-weight: 300;
}

.legends {
  padding-top: 20px;
  overflow: hidden;
}

.legend {
  display: block;
  width: 8px;
  height: 8px;
  margin-top: 15px;
  margin-bottom: 15px;
  border-radius: 50%;
}

.legend--this {
  background-color: #5555FF;
}

.legend--prev {
  background-color: #FF55B8;
}

.axis {
  position: absolute;
  color: #fff;
  z-index: 1;
  text-transform: uppercase;
  display: flex;
  width: 100%;
  bottom: 0;
}

.axis .tick {
  flex: 1;
  position: relative;
  overflow: hidden;
  opacity: 0.2;
  font-size: 11px;
  text-align: center;
  line-height: 40px;
  padding-top: 150px;
}

.axis .tick:hover {
  opacity: 1;
  background-color: rgba(255, 255, 255, 0.2);
}

.axis .tick .value {
  transform: translateY(-40px);
  transition: 0.3s transform;
  position: absolute;
  top: 20px;
  color: #444;
  border-radius: 2px;
  width: 100%;
  line-height: 20px;
}

.axis .tick:hover .value.value--this {
  transform: translateY(0);
  display: block;
}

.value.value--this {
  color: #5555FF;
  font-weight: bold;
}


#sideSchool{
  display: none;
}
@media screen and (min-width: 1200px) {
  #sideSchool {
    background-color: rgb(255, 255, 255);
    display: block;
  }
}
#chart-sales-darkss {
  background-color: white;
} 

</style>
{% endblock stylesheets %}

{% block content %}

    <!-- Header -->
    <div class="header bg-primary pb-6">
      <div class="container-fluid">
        <div class="header-body">
          <div class="row align-items-center py-4">
            <div class="col-lg-6 col-7">
              <h6 class="h4 text-white d-inline-block mb-0">Status</h6>
              
            </div>
           
          </div>
          <!-- Card stats -->
          <div class="row">
            <div class="col-xl-3 col-md-6">
              <div class="card card-stats">
                <!-- Card body -->
                <div class="card-body">
                  <div class="row">
                    <div class="col">
                      <h5 class="card-title text-uppercase text-muted mb-0">Total Budget</h5>
                      <span class="h2 font-weight-bold mb-0">350,897000</span>
                    </div>
                    <div class="col-auto">
                      <div class="icon icon-shape bg-gradient-red text-white rounded-circle shadow">
                        <i class="ni ni-active-40"></i>
                      </div>
                    </div>
                  </div>
                  <p class="mt-3 mb-0 text-sm">
                    <span class="text-success mr-2"><i class="fa fa-arrow-up"></i> 2.1%</span>
                    <span class="text-nowrap">for this current year</span>
                  </p>
                </div>
              </div>
            </div>
            <div class="col-xl-3 col-md-6">
              <div class="card card-stats">
                <!-- Card body -->
                <div class="card-body">
                  <div class="row">
                    <div class="col">
                      <h5 class="card-title text-uppercase text-muted mb-0">New Schools</h5>
                      <span class="h2 font-weight-bold mb-0">5</span>
                    </div>
                    <div class="col-auto">
                      <div class="icon icon-shape bg-gradient-orange text-white rounded-circle shadow">
                        <i class="ni ni-chart-pie-35"></i>
                      </div>
                    </div>
                  </div>
                  <p class="mt-3 mb-0 text-sm">
                    <span class="text-success mr-2"><i class="fa fa-arrow-up"></i> 3.48%</span>
                    <span class="text-nowrap">Since last week</span>
                  </p>
                </div>
              </div>
            </div>
            <div class="col-xl-3 col-md-6">
              <div class="card card-stats">
                <!-- Card body -->
                <div class="card-body">
                  <div class="row">
                    <div class="col">
                      <h5 class="card-title text-uppercase text-muted mb-0">Budget Spent</h5>
                      <span class="h2 font-weight-bold mb-0">924897</span>
                    </div>
                    <div class="col-auto">
                      <div class="icon icon-shape bg-gradient-green text-white rounded-circle shadow">
                        <i class="ni ni-money-coins"></i>
                      </div>
                    </div>
                  </div>
                  <p class="mt-3 mb-0 text-sm">
                    <span class="text-success mr-2"><i class="fa fa-arrow-up"></i> 10.48%</span>
                    <span class="text-nowrap">Current year</span>
                  </p>
                </div>
              </div>
            </div>
            <div class="col-xl-3 col-md-6">
              <div class="card card-stats">
                <!-- Card body -->
                <div class="card-body">
                  <div class="row">
                    <div class="col">
                      <h5 class="card-title text-uppercase text-muted mb-0">Reports</h5>
                      <span class="h2 font-weight-bold mb-0">10</span>
                    </div>
                    <div class="col-auto">
                      <div class="icon icon-shape bg-gradient-info text-white rounded-circle shadow">
                        <i class="ni ni-chart-bar-32"></i>
                      </div>
                    </div>
                  </div>
                  <p class="mt-3 mb-0 text-sm">
                    <span class="text-success mr-2"><i class="fa fa-arrow-up"></i> 5.02%</span>
                    <span class="text-nowrap">Replied to Schools</span>
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Page content -->
    <div class="container-fluid mt--6">
      <div class="row">
        <div class="col-xl-8">
          <div class="card">
            <div class="card-header bg-transparent">
              <div class="row align-items-center">
                <div class="col">
                  <h6 class="text-uppercase ls-1 mb-1">Overview</h6>
                  <h5 class="h3 text-black mb-0">Daily Budget View</h5>
                </div>
                <!-- <div class="col">
                  <ul class="nav nav-pills justify-content-end">
                    <li class="nav-item mr-2 mr-md-0" data-toggle="chart" data-target="#chart-sales-dark" data-update='{"data":{"datasets":[{"data":[0, 20, 10, 30, 15, 40, 20, 60, 60]}]}}' data-prefix="$" data-suffix="k">
                      <a href="#" class="nav-link py-2 px-3 active" data-toggle="tab">
                        <span class="d-none d-md-block">Month</span>
                        <span class="d-md-none">M</span>
                      </a>
                    </li>
                    <li class="nav-item" data-toggle="chart" data-target="#chart-sales-dark" data-update='{"data":{"datasets":[{"data":[0, 20, 5, 25, 10, 30, 15, 40, 40]}]}}' data-prefix="$" data-suffix="k">
                      <a href="#" class="nav-link py-2 px-3" data-toggle="tab">
                        <span class="d-none d-md-block">Week</span>
                        <span class="d-md-none">W</span>
                      </a>
                    </li>
                  </ul>
                </div> -->
              </div>
            </div>
            <div class="card-body">
              <!-- Chart -->
              <div class="chart">
                <!-- Chart wrapper -->
                <canvas id="chart-sales-darkss" class="chart-canvas" ></canvas>
              </div>
            </div>
          </div>
        </div>
        <div class="col-xl-4">
          <div class="card">
            <div class="card-header border-0">
              <div class="row align-items-center">
                <div class="col">
                  <h3 class="mb-0">Budget spent on provinces</h3>
                </div>
             
              </div>
            </div>
            <div class="table-responsive">
              <!-- Projects table -->
              <table class="table align-items-center table-flush">
                <thead class="thead-light">
                  <tr>
                    <th scope="col">Province</th>
                    <th scope="col">Budget</th>
                    <th scope="col">Spent</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th scope="row">
                      Pradesh 1
                    </th>
                    <td>
                      632045
                    </td>
                    <td>
                      <div class="d-flex align-items-center">
                        <span class="mr-2">60%</span>
                        <div>
                          <div class="progress">
                            <div class="progress-bar bg-gradient-danger" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 60%;"></div>
                          </div>
                        </div>
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <th scope="row">
                      Pradesh 2
                    </th>
                    <td>
                      834000
                    </td>
                    <td>
                      <div class="d-flex align-items-center">
                        <span class="mr-2">70%</span>
                        <div>
                          <div class="progress">
                            <div class="progress-bar bg-gradient-success" role="progressbar" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100" style="width: 70%;"></div>
                          </div>
                        </div>
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <th scope="row">
                      Pradesh 3
                    </th>
                    <td>
                      907020
                    </td>
                    <td>
                      <div class="d-flex align-items-center">
                        <span class="mr-2">80%</span>
                        <div>
                          <div class="progress">
                            <div class="progress-bar bg-gradient-primary" role="progressbar" aria-valuenow="80" aria-valuemin="0" aria-valuemax="100" style="width: 80%;"></div>
                          </div>
                        </div>
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <th scope="row">
                      Pradesh 4
                    </th>
                    <td>
                      3,678
                    </td>
                    <td>
                      <div class="d-flex align-items-center">
                        <span class="mr-2">75%</span>
                        <div>
                          <div class="progress">
                            <div class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100" style="width: 75%;"></div>
                          </div>
                        </div>
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <th scope="row">
                      Pradesh 5
                    </th>
                    <td>
                     230000
                    </td>
                    <td>
                      <div class="d-flex align-items-center">
                        <span class="mr-2">20%</span>
                        <div>
                          <div class="progress">
                            <div class="progress-bar bg-gradient-warning" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100" style="width: 20%;"></div>
                          </div>
                        </div>
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <th scope="row">
                      Pradesh 6
                    </th>
                    <td>
                      250000
                    </td>
                    <td>
                      <div class="d-flex align-items-center">
                        <span class="mr-2">30%</span>
                        <div>
                          <div class="progress">
                            <div class="progress-bar bg-gradient-success" role="progressbar" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100" style="width: 30%;"></div>
                          </div>
                        </div>
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <th scope="row">
                      Pradesh 7
                    </th>
                    <td>
                      200000
                    </td>
                    <td>
                      <div class="d-flex align-items-center">
                        <span class="mr-2">10%</span>
                        <div>
                          <div class="progress">
                            <div class="progress-bar bg-gradient-primary" role="progressbar" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100" style="width: 10%;"></div>
                          </div>
                        </div>
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
   
<h1>Budget Spent On Week</h1>
<div style="max-height: 1100px;">
  <canvas id="polarChart" style="height:500px;width:500px"></canvas>
</div>

    </div>

{% endblock content %}

<!-- Specific JS goes HERE --> 
{% block javascripts %}



  <script src="/static/assets/vendor/chart.js/dist/Chart.min.js"></script>
  <script src="/static/assets/vendor/chart.js/dist/Chart.extension.js"></script>

  <script>

    

  
  </script>

  <script>
   
  

   





var canvas = document.getElementById("canvass");

// Apply multiply blend when drawing datasets
var multiply = {
  beforeDatasetsDraw: function(chart, options, el) {
    chart.ctx.globalCompositeOperation = 'multiply';
  },
  afterDatasetsDraw: function(chart, options) {
    chart.ctx.globalCompositeOperation = 'source-over';
  },
};

// Gradient color - this week
var gradientThisWeek = canvas.getContext('2d').createLinearGradient(0, 0, 0, 150);
gradientThisWeek.addColorStop(0, '#5555FF');
gradientThisWeek.addColorStop(1, '#9787FF');

// Gradient color - previous week
var gradientPrevWeek = canvas.getContext('2d').createLinearGradient(0, 0, 0, 150);
gradientPrevWeek.addColorStop(0, '#FF55B8');
gradientPrevWeek.addColorStop(1, '#FF8787');





// import data from database
let thisWeek=[24, 18, 16, 18000, 24, 36, 28]
let previousWeek=[20, 22000, 30, 22, 18, 22, 30]




let elements=document.getElementsByClassName("value value--this")
for (var i = 0; i < elements.length; i++) {
  elements[i].innerHTML = thisWeek[i];
}

let elementss=document.getElementsByClassName("value value--prev")
for (var i1 = 0; i1 < elements.length; i1++) {
  elementss[i1].innerHTML = previousWeek[i1];
}






var config3 = {
    type: 'line',
    data: {
        labels: ["MON", "TUE", "WED", "THU", "FRI", "SAT", "SUN"],
        datasets: [
          {
              label: 'This week',
              data:thisWeek,
              backgroundColor: gradientThisWeek,
              borderColor: 'transparent',
              pointBackgroundColor: '#FFFFFF',
              pointBorderColor: '#FFFFFF',
              lineTension: 0.40,
          },
          {
              label: 'Previous week',
              data: previousWeek,
              backgroundColor: gradientPrevWeek,
              borderColor: 'transparent',
              pointBackgroundColor: '#FFFFFF',
              pointBorderColor: '#FFFFFF',
              lineTension: 0.40,
          }
        ]
    },
    options: {
    		elements: { 
        	point: {
          	radius: 0,
          	hitRadius: 5, 
            hoverRadius: 5 
          } 
        },
    		legend: {
        		display: false,
        },
        scales: {
            xAxes: [{
            		display: false,
            }],
            yAxes: [{
            		display: false,
                ticks: {
                	beginAtZero: true,
              	},
            }]
        }
    },
    plugins: [multiply],
};

window.chart = new Chart(canvas, config3);

  </script>





<script>
  fetch('/budget-api/')
  .then(response => response.json())
  .then(data1 => {
    // Create empty arrays for curr_date and total budget
    let dates = [];
    let budgets = [];

    // Iterate over the data and append to the dates and budgets arrays
    data1.forEach(item => {
      dates.push(item.curr_date);
      budgets.push(parseInt(item.total_budget));
    });

    // Log the arrays for testing
    console.log(dates);
    dates.unshift("2023-05-02")
    budgets.unshift(200000)
    dates.unshift("2023-05-01")
    budgets.unshift(500000)
    dates.unshift("2023-04-30")
    budgets.unshift(50000)

    
    console.log(budgets);
    const data = {
      labels: dates,
      datasets: [{
          label: 'In Rupees',
          data: budgets,
          fill: false,
          borderColor: 'orangered',
          tension: 0.1,
      }]
  };
    const config = {
      type: 'line',
      data: data,
      options: {
          responsive: true,
          interaction: {
              mode: 'nearest',
              intersect: false,
          },
          plugins: {
              title: {
                  display: true,
                  text: 'Continuous Curve',
                  color: 'black', // Change title color
              },
              tooltip: {
                  backgroundColor: 'rgba(0, 0, 0, 0.8)', // Change tooltip background color
                  titleColor: 'white', // Change tooltip title color
                  bodyColor: 'white', // Change tooltip body color
              }
          },
          backgroundColor: 'white', // Add this line
          scales: {
              x: {
                  ticks: {
                      color: 'black' // Change x-axis labels color
                  },
                  grid: {
                      color: 'rgba(0, 0, 0, 0.1)' // Change x-axis gridline color
                  }
              },
              y: {
                  ticks: {
                      color: 'black' // Change y-axis labels color
                  },
                  grid: {
                      color: 'rgba(0, 0, 0, 0.1)' // Change y-axis gridline color
                  }
              }
          },
      },
  };

  const myChart = new Chart(
    document.getElementById("chart-sales-darkss"),
    config
);





const data2 = {
  labels:dates,
  datasets: [{
    label: 'In Rupees',
    data: budgets,
    backgroundColor: [
        'rgb(255, 99, 132)',
            'orange',
            'yellow',
            'green',
            'blue',
            'indigo',
            'violet',
            'gray'
        ]
    }]
};
var screenWidth = window.innerWidth;
const config1 = {
  type: 'polarArea',
    data: data2,
    options: {
        plugins: {
            legend: {
              
              position: screenWidth < 500 ? 'bottom' : 'right'
            }
        }
    }
};






const myChart1 = new Chart(
  document.getElementById("polarChart"),
  config1
);










  })
  .catch(error => console.error(error));
</script>



{% endblock javascripts %}
